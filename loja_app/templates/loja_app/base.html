{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="{% static 'css/styles.css' %}">
  <link rel="icon" href="{% static 'img/favicon.ico' %}" />
  <title>Nutri Amorim</title>
</head>
<body>

  <!-- Topbar -->
  <div class="topbar">
    <!-- Menu -->
    <div class="menu-icon">
      <div class="bar bar1"></div>
      <div class="bar bar2"></div>
      <div class="bar bar3"></div>
    </div>

    <!-- Barra de Pesquisa -->
    <div class="search-box">
      <input type="text" placeholder="Pesquisar...">
    </div>

    <!-- Bot√µes de Login e Sair -->
    <div class="auth-button">
      {% if user.is_authenticated %}
        <!-- Bot√£o de sair se o usu√°rio estiver logado -->
        <a href="{% url 'logout' %}">
          <button>Sair</button>
        </a>
      {% else %}
        <!-- Bot√£o de login se o usu√°rio n√£o estiver logado -->
        <a href="{% url 'login' %}">
          <button>Entrar / Criar Conta</button>
        </a>
      {% endif %}
    </div>

</div>
</div>

</body>
</html>

<!-- Subtopbar -->
<div class="subtopbar">
  <!-- Marcas √† esquerda -->
  <div class="dropdown-left">
    <button class="dropbtn">Marcas</button>
    <div class="dropdown-content">
      <a href="#">Marca 1</a>
      <a href="#">Marca 2</a>
      <a href="#">Marca 3</a>
      <!-- Adicione mais marcas -->
    </div>
  </div>

<!-- Bot√µes centrais sem √≠cones -->
<ul class="subtopbar-links">
  <li>
    <a href="{% url 'way_protein' %}">Way Protein</a>
  </li>
  <li>
    <a href="{% url 'creatinas' %}">Creatinas</a>
  </li>
  <li>
    <a href="{% url 'pre_treino' %}">Pr√© Treino</a>
  </li>
  <li>
    <a href="{% url 'emagrecedores' %}">Emagrecedores</a>
  </li>
  <li>
    <a href="{% url 'acessorios' %}">Acess√≥rios</a>
  </li>
</ul>
  
  <!-- Categorias √† direita -->
  <div class="dropdown-right">
    <button class="dropbtn">Categorias</button>
    <div class="dropdown-content">
      <a href="{% url 'way_protein' %}">Way Protein</a>
      <a href="{% url 'pre_treino' %}">Pr√© Treino</a>
      <a href="{% url 'emagrecedores' %}">Emagrecedores</a>
      <a href="{% url 'acessorios' %}">Acess√≥rios</a>
      <a href="{% url 'bcaa' %}">Bcaa</a>
      <a href="{% url 'albumina' %}">Albumina</a>
      <a href="{% url 'aumento_testosterona' %}">Aumento da Testosterona</a>
      <a href="{% url 'bebidas' %}">Bebidas</a>
      <a href="{% url 'ciclistas' %}">Ciclistas</a>
      <a href="{% url 'coffee' %}">Coffee</a>
      <a href="{% url 'colageno' %}">Col√°geno</a>
      <a href="{% url 'dose_unica' %}">Dose √önica</a>
      <a href="{% url 'melatonina' %}">Melatonina</a>
      <a href="{% url 'omega_3' %}">Omega 3</a>
      <a href="{% url 'forca_energia' %}">For√ßa e Energia</a>
      <a href="{% url 'vitaminas' %}">Vitaminas</a>
      <a href="{% url 'aumentar_massa_muscular' %}">Aumentar Massa Muscular</a>
      <a href="{% url 'aminoacidos' %}">Amino√°cidos</a>
      <a href="{% url 'articulacoes_saudaveis' %}">Articula√ß√µes Saud√°veis</a>
      <a href="{% url 'barras_de_proteinas' %}">Barras de Prote√≠nas</a>
      <a href="{% url 'antioxidantes' %}">Antioxidantes</a>
      <a href="{% url 'carboidratos' %}">Carboidratos</a>
      <a href="{% url 'glutaminas' %}">Glutaminas</a>
      <a href="{% url 'pastas_de_amendoim' %}">Pastas de Amendoim</a>
      <a href="{% url 'caldas_e_molhos' %}">Caldas e Molhos</a>
      <a href="{% url 'snacks_doces' %}">Snacks e Doces</a>
      <a href="{% url 'combos' %}">Combos</a>
    </div>
  </div>
</div>

<!-- Sidebar -->
  <div id="sidebar" class="sidebar">
      <div class="logo-container">
        <img src="{% static 'img/imagem_nutri.png' %}" alt="Logo Nutri Amorim" class="logo-img">
      </div>
      <ul>

        <li class="sidebar-auth">
          {% if user.is_authenticated %}
            <a href="{% url 'logout' %}"><button>Sair</button></a>
          {% else %}
            <a href="{% url 'login' %}"><button>Entrar / Criar Conta</button></a>
          {% endif %}
        </li>
        <li><a href="{% url 'home' %}" class="inicio-link">In√≠cio</a></li>

      <!-- As outras abas seguem aqui -->
        <li>
          <a class="toggle">Ofertas</a>
          <ul class="submenu">
            <li><a href="{% url 'produtos' %}">Produtos</a></li>
            <li><a href="{% url 'carrinho' %}">Carrinho</a></li>
            <li><a href="{% url 'finalizar_compra' %}">Finalizar Compra</a></li>
          </ul>
        </li>

      <li><a href="{% url 'saude' %}"> Sa√∫de</a></li>
      <li><a href="{% url 'projetos' %}"> Projetos</a></li>
        
      <li>
        <a class="toggle">Receitas Medicinais</a>
        <ul class="submenu">
          <li><a href="{% url 'informativo' %}"> Informativo</a></li>
          <li><a href="{% url 'entenda_doencas_e_causas' %}"> Entenda Doen√ßas e Causas</a></li>
        </ul>
      </li>
    
      <li>
        <a class="toggle">Pesquisas Cient√≠ficas</a>
        <ul class="submenu">
          <li><a href="{% url 'comprovacao_cientifica' %}">üî¨ Comprova√ß√£o Cient√≠fica</a></li>
          <li><a href="{% url 'remedios_naturais_que_a_ciencia_comprova' %}">üå± Rem√©dios Naturais</a></li>
        </ul>
      </li>
    
      <li>
        <a class="toggle">Consultas</a>
        <ul class="submenu">
          <li><a href="{% url 'agendamento_online' %}">üìÖ Agendamento Online</a></li>
          <li><a href="{% url 'avaliacao_fisica' %}">üìè Avalia√ß√£o F√≠sica</a></li>
          <li><a href="{% url 'planos_alimentares' %}">üìã Planos Alimentares</a></li>
        </ul>
      </li>
    
      <li><a href="{% url 'sobre_mim' %}"> Sobre Mim</a></li>
      <li><a href="{% url 'conheca_nosso_trabalho' %}"> Nosso Trabalho</a></li>
      <li><a href="{% url 'normas_e_regulamento' %}">üìë Normas</a></li>
      <li><a href="{% url 'conhecimento_na_pratica' %}">üß† Conhecimento na Pr√°tica</a></li>
    </ul>
   </div>

<!-- Conte√∫do principal -->
<div class="content">
  {% block content %}
  {% endblock %}
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const toggles = document.querySelectorAll('.toggle'); // Bot√µes de altern√¢ncia de submenu
    const submenuState = JSON.parse(localStorage.getItem('openSubmenus')) || []; // Estado salvo no localStorage

    // Inicializa o estado das sub-abas baseado no localStorage
    toggles.forEach((toggle, index) => {
      const submenu = toggle.nextElementSibling;
      if (submenuState.includes(index)) {
        submenu.classList.add('show'); // Abre as sub-abas que estavam abertas
        toggle.classList.remove('closed'); // √çcone de aba aberta
      } else {
        submenu.classList.remove('show'); // Fecha as sub-abas que estavam fechadas
        toggle.classList.add('closed');   // √çcone de aba fechada
      }

      toggle.addEventListener('click', () => {
        const isOpen = submenu.classList.contains('show');
        
        // Atualiza o estado da sub-aba
        if (isOpen) {
          submenu.classList.remove('show');
          toggle.classList.add('closed'); // Muda o √≠cone para fechado
        } else {
          submenu.classList.add('show');
          toggle.classList.remove('closed'); // Muda o √≠cone para aberto
        }

        // Atualiza o estado no localStorage
        updateSubmenuState();
      });
    });

    // Fun√ß√£o para atualizar o estado das abas no localStorage
    function updateSubmenuState() {
      const openSubmenus = [];
      toggles.forEach((toggle, index) => {
        const submenu = toggle.nextElementSibling;
        if (submenu.classList.contains('show')) {
          openSubmenus.push(index);
        }
      });
      localStorage.setItem('openSubmenus', JSON.stringify(openSubmenus));
    }

    // Script para mostrar/ocultar a sidebar ao clicar no menu hamb√∫rguer
    const menuIcon = document.querySelector('.menu-icon'); // √çcone do menu hamb√∫rguer
    const sidebar = document.querySelector('.sidebar'); // Sidebar a ser exibida/ocultada

    if (menuIcon && sidebar) {
      menuIcon.addEventListener('click', () => {
        menuIcon.classList.toggle('open');  // Anima o √≠cone de hamb√∫rguer
        sidebar.classList.toggle('show');   // Exibe ou esconde a sidebar
      });
    }

    // Fun√ß√£o para ajustar a visibilidade da sidebar conforme o tamanho da tela
    function adjustSidebarForScreenSize() {
      const screenWidth = window.innerWidth;

      if (screenWidth <= 1600) { // Para telas 
        // No mobile/tablet, a sidebar deve estar escondida por padr√£o
        sidebar.classList.remove('show');
        menuIcon.classList.remove('open');
      } else { // Para telas grandes (desktops)
        // Para desktops, a sidebar pode ser fixada, sem necessidade de anima√ß√£o
        sidebar.classList.add('show');
        menuIcon.classList.add('open');
      }
    }

    // Ajusta a sidebar quando a tela for redimensionada
    window.addEventListener('resize', adjustSidebarForScreenSize);
    
    // Chama a fun√ß√£o para configurar a visibilidade inicial da sidebar
    adjustSidebarForScreenSize();


// Fun√ß√£o para redirecionar o usu√°rio para a p√°gina de produtos
function irAsCompras() {
  window.location.href = '/produtos'; // Substitua pelo link da sua p√°gina de produtos
}
});

document.addEventListener("click", function (event) {
    // Fecha dropdowns se clicar fora
    const isButton = event.target.classList.contains("dropbtn");
    if (!isButton) {
      document.querySelectorAll(".dropdown-content").forEach(dropdown => {
        dropdown.style.display = "none";
      });
    }
  });

  document.querySelectorAll(".dropbtn").forEach(button => {
    button.addEventListener("click", function (e) {
      e.stopPropagation();
      const dropdown = this.nextElementSibling;
      const isOpen = dropdown.style.display === "block";

      // Fecha todos
      document.querySelectorAll(".dropdown-content").forEach(d => d.style.display = "none");

      // Abre se n√£o estava aberto
      if (!isOpen) {
        dropdown.style.display = "block";
      }
    });
  });

</script>